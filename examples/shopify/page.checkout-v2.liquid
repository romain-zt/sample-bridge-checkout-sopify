{% comment %}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEMPLATE: Page Checkout Custom (Shopify)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Template de page checkout personnalisÃ© avec intÃ©gration Stripe Bridge.

STRUCTURE:
- Formulaire client (email, tÃ©lÃ©phone, nom)
- Liste des produits du panier
- Section remises/gift cards
- RÃ©capitulatif et bouton de paiement

âš ï¸ PERSONNALISATION REQUISE:
- Adaptez les CSS Ã  votre thÃ¨me
- Remplacez les textes/placeholders
- Modifiez les liens de navigation
- Ajustez les snippets renders (checkout-product-list-v2, etc.)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
{% endcomment %}

{% comment %} âš ï¸ TODO: CrÃ©ez le fichier CSS correspondant {% endcomment %}
{% comment %}
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  page.checkout-v2.liquid - Shopify Bridge Checkout Example               â•‘
â•‘                                                                           â•‘
â•‘  Description: Template Shopify personnalisÃ© pour checkout avec Stripe    â•‘
â•‘                                                                           â•‘
â•‘  âš ï¸ Ce code nÃ©cessite adaptation Ã  votre contexte spÃ©cifique             â•‘
â•‘     (logique fidÃ©litÃ©, gift cards, styles CSS, messages FR)              â•‘
â•‘                                                                           â•‘
â•‘  ğŸ†˜ Support: romain@zedtech.fr                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
{% endcomment %}

{{ 'checkout-v2.css' | asset_url | stylesheet_tag }}  

<div class="checkout-container">
  {% if cart.item_count != 0 %}

    <style>
      /* âš ï¸ TODO: Adapter Ã  votre thÃ¨me */
      #shopify-section-announcement {  
        display: none;  
      }  
      
      #shopify-section-header {  
        position: fixed;  
        z-index: 10000;  
        top: 0;  
        left: 0;  
        width: 100%;  
      }
        
      @media (max-width: 768px) {  
        #shopify-section-framework--footer,  
        #shopify-chat {  
          display: none;  
        }
      }
    </style>
    
    {% comment %} â”€â”€â”€ Titre de page â”€â”€â”€ {% endcomment %}
    <h1 class="page-title">
      {% if customer %}
      {{ customer.first_name | camelcase }},<br>
      {% endif %}
      <span class="page-title-common">
      {{ page.title }}
      </span>
    </h1>
    
    {% comment %} Champs cachÃ©s pour prÃ©-remplir si client connectÃ© {% endcomment %}
    <input type="hidden" id="customer_first_name" value="{{ customer.first_name }}">
    <input type="hidden" id="customer_last_name" value="{{ customer.last_name }}">
    <input type="hidden" id="customer_phone" value="{{ customer.phone }}">

    {% endif %}

    {% comment %} 
    â”€â”€â”€ Section Hero (optionnelle) â”€â”€â”€
    âš ï¸ TODO: Personnalisez ou supprimez cette section
    Exemple: message de bienvenue, avantages, etc.
    {% endcomment %}
    {% if cart.total_price > 0 %}
  <div class="hero-section">
    <div class="hero-text">
        <strong style="text-align: center; margin: auto; width: 100%; display:block; margin-top: 5px;">
          {% if customer.email %}
            {% comment %} âš ï¸ TODO: Message personnalisÃ© client connectÃ© {% endcomment %}
            Merci pour votre fidÃ©litÃ© !
          {% else %}
            {% comment %} âš ï¸ TODO: Incitation Ã  la connexion {% endcomment %}
            <a style="text-decoration: underline;" href="/account/login?checkout_url=/pages/checkout">Connectez-vous</a>
            pour bÃ©nÃ©ficier de vos avantages
          {% endif %}
        </strong>
    </div>
  </div>
      {% endif %}
  {% if cart.item_count != 0 %}

    {% comment %} â•â•â• FORMULAIRE CLIENT â•â•â• {% endcomment %}
    {% comment %} âš ï¸ TODO: Adaptez les labels/placeholders Ã  votre langue {% endcomment %}
    <div class="customer-infos-section">
  <div class="customer-info-grid">
    
    <div class="info-field">
      <label for="customerEmail" class="info-label">Email</label>
      {% if customer.email %}
        <input
          type="email"
          id="customerEmail"
          name="email"
          autocomplete="email"
          value="{{ customer.email }}"
          placeholder="votre@email.com"
          required
          readonly="true"
          class="info-input"
        >
      {% else %}
        <input
          type="email"
          id="customerEmail"
          name="email"
          autocomplete="email"
          placeholder="votre@email.com"
          required
          class="info-input"
        />
      {% endif %}
      <span class="validation-message"></span>
    </div>

    <div class="info-field">
      <label for="customerPhone" class="info-label">TÃ©lÃ©phone</label>
      <input
        type="tel"
        name="phone"
        id="customerPhone"
        autocomplete="tel"
        value="{{ customer.phone }}"
        placeholder="+33 6 01 02 03 04"
        required
        class="info-input"
      >
      <span class="validation-message"></span>
    </div>
    
    <div class="info-field">
      <label for="customerFirstName" class="info-label">PrÃ©nom</label>
      <input
        type="text"
        id="customerFirstName"
        name="firstname"
        autocomplete="given-name"
        value="{{ customer.first_name }}"
        placeholder="Jean"
        required
        class="info-input"
      >
      <span class="validation-message"></span>
    </div>

    <div class="info-field">
      <label for="customerLastName" class="info-label">Nom</label>
      <input
        type="text"
        name="lastname"
        id="customerLastName"
        autocomplete="family-name"
        value="{{ customer.last_name }}"
        placeholder="DUPONT"
        required
        class="info-input"
      >
      <span class="validation-message"></span>
    </div>
  </div>
</div>
    
    {% endif %}

  {% comment %} 
  â•â•â• LISTE DES PRODUITS â•â•â•
  âš ï¸ TODO: CrÃ©ez le snippet 'checkout-product-list-v2' ou adaptez Ã  votre existant
  {% endcomment %}
  {% render 'checkout-product-list-v2' %}

  {% if cart.item_count == 0 %}
    {% comment %} âš ï¸ TODO: Personnalisez le message panier vide {% endcomment %}
    <div class="empty-cart">
      <h1 class=".h3">Votre panier est vide</h1>
      <p>
        <a href="/collections/all">Continuer vos achats</a>
      </p>
    </div>
  {% endif %}


  {% if cart.item_count != 0 %}

  {% comment %} 
  â•â•â• SECTION REMISES/GIFT CARDS â•â•â•
  âš ï¸ TODO: CrÃ©ez le snippet 'checkout-discount-v2' pour le formulaire de code promo
  {% endcomment %}
  {% render 'checkout-discount-v2' %}

    {% comment %} â•â•â• RÃ‰CAPITULATIF PRIX â•â•â• {% endcomment %}
    <div class="subtotal-container">
      <div class="subtotal amount">
        <span>Sous-total</span>
        <span>{{ cart.items_subtotal_price | money }}</span>
      </div>
      
      {% if cart.total_discounts > 0 %}
        <div class="subtotal discount-amount">
          <span>RÃ©duction</span>
          <span>-{{ cart.total_discounts | money }}</span>
        </div>
      {% endif %}
    
      {% comment %} 
      â”€â”€â”€ Affichage gift card (optionnel) â”€â”€â”€
      Calcule le montant applicable (max = total restant)
      {% endcomment %}
      {% if cart.note.size > 0 and cart.attributes.giftCard.amount > 0 %}
        {% assign remaining_price = cart.total_price %}
        {% assign gift_card_amount = cart.attributes.giftCard.amount %}
        
        {% if gift_card_amount > remaining_price %}
          {% assign applicable_gift_card = remaining_price %}
        {% else %}
          {% assign applicable_gift_card = gift_card_amount %}
        {% endif %}
        
        {% if applicable_gift_card > 0 %}
          <div class="subtotal giftcard-amount">
            <span>Carte cadeau</span>
            <span>-{{ applicable_gift_card | money }}</span>
          </div>
        {% endif %}
      {% endif %}
    </div>
  
  {% comment %} â•â•â• SECTION TOTAL & CTA â•â•â• {% endcomment %}
  <div class="checkout-cta-wrapper">
    <div class="totals-section">
      <div class="total">
        <span>Total</span>
        {% if cart.note.size && cart.attributes.giftCard.amount > 0 %}
        <span>{{ cart.total_price | minus: cart.attributes.giftCard.amount | money }}</span>
        {% else %}
        <span>{{ cart.total_price | money }}</span>
        {% endif %}
      </div>

      {% comment %} 
      âš ï¸ TODO (optionnel): Affichage paiement en 3x
      Adaptez les montants min/max selon vos besoins
      Exemple: Klarna, Alma, etc.
      {% endcomment %}
      {% if cart.attributes.giftCard.amount > 0 && cart.total_price - cart.attributes.giftCard.amount > 4500 && cart.total_price - cart.attributes.giftCard.amount < 450000 %}  
        <small style="text-align: right; font-weight: 500; margin-top: -18px;">  
          ou 3 x {{ cart.total_price | minus: cart.attributes.giftCard.amount | times: 1.0 | divided_by: 3.0 | ceil | money }}  
        </small>  
      {% elsif cart.attributes.giftCard.amount <= 0 && cart.total_price > 4500 && cart.total_price < 450000 %}  
        <small style="text-align: right; font-weight: 500; margin-top: -18px;">  
          ou 3 x {{ cart.total_price | times: 1.0 | divided_by: 3.0 | ceil | money }}  
        </small>  
      {% endif %}  
    </div>

    {% comment %} âš ï¸ TODO: Personnalisez le texte du bouton {% endcomment %}
    <button class="checkout-cta">Payer</button>
  </div>
        {% endif %}
</div>

{% comment %} â•â•â• INTEGRATION STRIPE BRIDGE â•â•â• {% endcomment %}
{% render 'stripe-bridge' %}

{% comment %}
ğŸ“š DOCUMENTATION COMPLÃˆTE: /docs/QUICK_START.md
ğŸ†˜ SUPPORT: romain@zedtech.fr ou GitHub Issues
{% endcomment %}